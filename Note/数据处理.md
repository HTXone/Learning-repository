# 数据处理

#### 数据分析过程

确定目标数据
目标数据采集   非概率抽样，概率抽样：简单随机，等距，分层，整群
数据清洗
数据存储
数据分析
结果可视化及结果支持的决策

#### 数据类型

结构化分类：结构数据（数据库），非结构数据

连续性分类：连续型数据，离散型数据

测量尺度分类：定类数据（离散型），定序数据（离散型），定距数据（连续型），定比数据（连续型）


| 数据类型 \数据运算 | 等于或不等于 | 大于或小于 | 加或减 | 乘或除 |
| ------------------ | ------------ | ---------- | ------ | ------ |
| 定类               | √            |            |        |        |
| 定序               | √            | √          |        |        |
| 定距               | √            | √          | √      |        |
| 定比               | √            | √          | √      | √      |

#### 数据描述维度

集中趋势描述，离散程度描述，分布形态描述

#### 集中趋势描述(通过数据显示出来的信息展示内容趋势)

算数平均值：简单算术平均值，加权算数平均值    
（极端值会影响数据趋势）

几何平均值 （在连续前序问题上使用）：
$$
\overline{x_{j}} = \sqrt[n]{x_{1}x_{2}...x_{n}}
$$
众数（最多需求），中位数（剔除极端数据影响）

#### 数据离散程度描述

极差（数据覆盖范围）
$$
R = x_{max}-x{min}
$$
平均偏差(数据稳定性判断)
$$
R_{a} = \frac{\sum\limits_{i=1}^n |x_{i}-\overline{x}|}{n}
$$
方差和标准差
总体方差
$$
\sigma^2 = \frac{\sum\limits_{i=1}^n (x_{i}-\mu)^2}{N} //(\mu 为平均值)
$$
样本方差
$$
良好估计（样本在总体内分散）：与总体方差公式相同\\有偏估计（样本在总体内聚集）：s^2 = \frac{\sum\limits_{i=1}^n (x_{i}-\overline{x})^2}{n-1}
$$
变异系数（不同数据量集合的相对离散程度）
$$
总体变异系数：V_{\sigma} = \frac{\sigma}{\mu}\\样本变异系数：V_{s} = \frac{s}{\overline{x}}
$$
四分位极差
$$
取数据的四分位数据 Q_{1}（第1/4位的数）Q_{2}（中位数）Q_{3}（第3/4位的数）\\
R = (Q_{3}-Q_{1})
$$

#### 数据的分布形态描述

概率
$$
古典概率法： P(A) = \frac{1}{N}\\统计概率法： P(A) = \frac{n}{N}\\主观概率法：主观猜测概率
$$
概率分布
二项分布 结果两级化
$$
设成功概率为p 失败概率为q:(1-p)\\P(X = x) = C^x_{n}p^xq^{(n-x)} = \frac{n!}{x!(n-x)!}p^xq^{n-x}\\均值：\mu=np \\方差:\sigma^2 = npq
$$


多项分布 
$$
联合概率质量函数(进行n次抽样 共k项结果)：\\P(x_{1}x_{2}...x_{k}) = (\frac{n!}{x_{1}!x_{2}!...x_{k}!})p^{x_{1}}_{1}p^{x_2}_{2}...p^{x_{k}}_{k}
$$
超几何分布（不放回抽样）
$$
k：结果数 n：取样数 m：k类总数 N：总数\\f(k;n,m,N) = \frac{C^k_{n}C^{n-k}_{N-m}}{C^{n}_{N}}
$$
泊松分布（基于过去某个随机事件在某段时间或空间中发生的平均次数，预测该随机事件在未来同样长时间或空间中发生n次的概率）
$$
P(X = k) = \frac{e^{-\lambda}\lambda^k}{k!}\\均值\mu = \lambda\\方差\sigma = \lambda
$$
指数分布（两次随机事件发生的时间间隔的概率分布情况）
$$
x:给定时间长度\\
\mu ：随机事件发生一次的平均时间\\
f(x) =
\begin{cases}
0 \qquad & x \lt 0 \\
\frac{1}{\mu}e^{-\frac{1}{\mu}x} = \lambda e^{-\lambda x} \qquad & x \ge 0
\end{cases}
$$
均匀分布
$$
f(x)=
\begin{cases}\frac{1}{b-a} & a<x<b
\\
0&x<a,x>b
\end{cases}
$$
正态分布
$$
\mu:均值（标准0）\\
\sigma:标准差（标准1）
\\f(x) = \frac{1}{\sigma \sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}
$$
峰度系数（比较正态分布函数的陡峭度）
$$
kurtosis = \frac{\sum^k_{i=1}(x_{i}-\overline x)^4F_{i}}{\sigma^4\sum^{k}_{i=1}F_{i}}\\\overline x:总体均值\\F_{i}:分组频数\\\sigma:总体标准差
$$
偏度系数（比较正态分布函数峰值偏移程度）
$$
skewness = \frac{\sum^k_{i=1}(x_{i}-\overline x)^3F_{i}}{\sigma^3\sum^{k}_{i=1}F_{i}}
$$

#### 抽样

简单随机抽样，分层抽样，系统随机抽样，整体随机抽样，偏差（非随机）抽样

#### 抽样分布

通过抽样分布来从样本参数推断总体参数
如果有容量为无限或有限的总体，从中抽取一个样本容量为n的样本，并对样本进行测量，就可以获得一套样本参数，如果进行k次样本容量为n的抽样就可以获得看套样本参数。其中例如k个均值组成的概率分布就称为均值的样本分布。

常用抽样分布：Z分布，T分布，F分布，卡方(x^2^)分布

#### Z分布

中心极限定理：不论总体服从什么分布，只要从总体中抽取的样本容量足够大，这些样本组成的样本均值的抽样分布都近似于正态分布。

均值分布性质：
$$
抽样分布均值： \mu_{c} \\ 抽样分布标准差：\sigma_{c} \\ \mu_{c} = \mu_{z} \: \: 均值抽样分布等于总体抽样分布 \\通过总体标准差\sigma_{z}求抽样分布标准差\sigma_{c}：\\无限总体抽样与有限总体有返回抽样: \: \sigma_{c}=\frac{\sigma{z}}{\sqrt{n}} \:\:\:\:\:\:（n为样本容量）\\有限总体无返回抽样:\sigma_{c} = \frac{\sigma{z}}{\sqrt{n}}\sqrt{\frac{N-n}{N-1}}\:\:\:\:\:\:\:(N为有限总体容量，\:\sqrt{(N-n)/(N-1)}表示修正因子\\ 当总体容量在样本容量20倍以上，修正因子等于1)
$$
Z分布
两种均值抽样分布满足正态分布：从正态分布总体中抽样，任意分布总体且样本容量大于等于30时
转换为标准正态分布的均值抽样分布称为Z分布
$$
Z = \frac{\overline{x}-\mu_{z}}{\frac{\sigma_{z}}{\sqrt{n}}}\sim N(0,1)\\Z = \frac{\overline{x}-\mu_{z}}{\frac{\sigma_{z}}{\sqrt{n}}\sqrt{\frac{N-n}{N-1}}}\sim N(0,1)
$$
通过样本均值推断总体均值

#### T分布

$$
T统计量: \\t(v) = t(n-1) = \frac{\overline{x}- \mu_{z}}{\frac{s}{\sqrt{n}}}\\
\overline{x}: 样本均值；s:样本标准差； \mu总体均值；v:自由度；n:样本容量；t:T统计量的值
$$



相较于Z统计量 T统计量只需要指导样本标准差即可计算而非需要总体标准差

如果一直等待分析的总体付出正态分布，从总体中抽取容量为n的所有可能样本，对每个样本都计算T统计量，则所有T统计量的值将组成一个连续型概率分布，次分布为T分布
$$
	T分布概率密度函数:\\
	f(t) = c(1+\frac{t^2}{v}^{-(v+1)/2})\\t: T统计量的值;\:v:自由度(等于n-1);\:c:常数，使T分布函数曲线下的面积等于1
$$
如果总体服从正态分布，样本容量小于30 则样本均值的抽样分布服从T~t(n-1)的T分布；如果总体服从正态分布，总体标准差未知，样本容量大于等于30时，样本均值的抽样分布不仅服从T分布 还可以用Z分布来近似表达

T分布能够在部分已知条件下，用于总体均值的推断分析，与Z分布是适用范围相补充的关系

#### 切比雪夫定理

一种统计规则
$$
假设有数据集合（x_1 x_2 ... x_n） 其均值等于\mu\: 标准差等于\sigma\\对仍以数k\ge1位于区间[\mu-k\sigma,\mu+k\sigma] 内的个案比例会\ge(1-1/k^2)\\
P(\mu\pm k \sigma)\ge1-1/k^2\\
如果数据集合来自总体的一个随机样本，样本均值等于总体均值\mu样本标准差s是总体标准差的合理估计\\则s = \sigma代入计算
$$
$$均值抽样分布适用条件表\:总体标准差\sigma已知$$

| 均值抽样分布   | 总体情况 | 样本容量 | 精确度 |
| -------------- | -------- | -------- | ------ |
| Z              | 正态     | N>=30    | 精确   |
| Z              | 正态     | N<30     | 精确   |
| Z              | 非正态   | N>=30    | 近似   |
| 切比雪夫不等式 | 非正态   | N<30     | 近似   |

$$均值抽样分布适用条件表\:总体标准差\sigma未知$$

| 均值抽样分布   | 总体情况 | 样本容量 | 精确度 |
| -------------- | -------- | -------- | ------ |
| T/Z            | 正态     | N>=30    | 精确   |
| T              | 正态     | N<30     | 近似   |
| Z              | 非正态   | N>=30    | 近似   |
| 切比雪夫不等式 | 非正态   | N<30     | 近似   |

#### 卡方分布

卡方统计量：标明样本方差和总体方差之间的比值关系。卡方统计量决定的抽样分布就卡方分布
$$
\chi ^2 = \frac{(n-1)s^2}{\sigma^2}
$$
如果样本量为n的所有可能样本军取自方差为$\sigma^2$的正态分布总体，最美一个个样本都计算其卡方值，那么这些卡方值将构成关于样本方差和总体方差的卡方分布。卡方分布是一个连续型概率分布其概率密度函数为
$$
f(\chi^2) = c(\chi^2)^{\frac{v}{2}-1}e^{-\frac{\chi^2}{2}}\\
v:自由度\\
c:调节常数，使卡方分布曲线下方的面积为1
$$
卡方分布能优与从样本方差到总体方差的推断性分析，还可以用于非参数检验

#### F分布

从俩个样本间关系推导两个总体间关系

F统计量公式
$$
F = \frac{s^2_1\sigma^2_2}{s^2_2\sigma^2_1}\\
F = \frac{\chi^2_1/v_1}{\chi^2_2/v_2}
$$
F分布概率密度函数：
$$
f(F) = cF^{\frac{v_1}{2}-1}(1+\frac{v_1F}{v_2})^{\frac{(v_1+v_2)}{2}}\\
v: 自由度\\
c:修正常数\: 使F分布曲线下方总面积等于1
$$
F分布可用于推断两个总体方差间的比值关系

#### 参数估计

用抽样分布作为中介，用样本的参数特征等于总体的参数进行数值估计的过程。

点估计：用某个具体的样本参数值直接代表未知的总体参数。

区间估计：推断总体参数时，根据抽样分布的特征，给出可能包含总体参数的一个数值区间，同时给出总体参数落在这个区间的可能性。

置信区间：根据样本信息推导出来可能包含总体参数的数值区间。

置信水平：置信区间的可信度。

显著水平：置信水平表示为$(1-\alpha)100\%$ 其中$\alpha$为显著性水平

双侧/单侧置信区间：双侧时需要同时考虑置信区间的上限和下限，单侧时只需要考虑其中一个即可。

#### Z分布与总体均值的区间估计

$$
总体标准差已知\:总体均值抽样分布服从正态分布\\
置信水平为(1-\alpha)\\
P(\overline x_{1-\frac{a}{2}}\le \overline x \le \overline x_{\frac{a}{2}}) = 
P(-z_{\frac{a}{2}}\le  z \le z_{\frac{a}{2}}) = 
P(-z_{\frac{a}{2}}\le  \frac{\overline x - \mu_z}{\frac{\sigma _ z}{\sqrt n}} \le z_{\frac{a}{2}}) = 1-\alpha
\\
有限总体\: 总体容量与样本容量比小于20\:添加修正因子\\
P(-z_{\frac{a}{2}}\le  \frac{\overline x - \mu_z}{\frac{\sigma _ z}{\sqrt n}\sqrt{\frac{N-n}{N-1}}} \le z_{\frac{a}{2}}) = 1-\alpha
\\
总体标准差\sigma未知，但样本容量大于30，样本标准差s是总体标准差\sigma_z的一个合理估计，\\用s代替\sigma_z进行计算\\
公式转换：\\
P(-z_{\frac{a}{2}}\le  \frac{\overline x - \mu_z}{\frac{\sigma _ z}{\sqrt n}} \le z_{\frac{a}{2}}) = 1-\alpha\\
\Rightarrow P(\overline x - z_{\frac{a}{2}}\frac{\sigma_z}{\sqrt n}\le \mu_z \le \overline x + z_{\frac{a}{2}}\frac{\sigma_z}{\sqrt n}) = 1-a\\ \\ \\
P(-z_{\frac{a}{2}}\le  \frac{\overline x - \mu_z}{\frac{\sigma _ z}{\sqrt n}\sqrt{\frac{N-n}{N-1}}} \le z_{\frac{a}{2}}) = 1-\alpha
\\
\Rightarrow P(\overline x - z_{\frac{a}{2}}\frac{\sigma_z}{\sqrt n}\sqrt{\frac{N-n}{N-1}}\le \mu_z \le \overline x + z_{\frac{a}{2}}\frac{\sigma_z}{\sqrt n}\sqrt{\frac{N-n}{N-1}}) = 1-a
$$

#### T分布与总体均值区间估计


$$
总体服从正态分布 总标准差未知时\\
P(-t_{\frac{a}{2}}(n-1)\le  \frac{\overline x - \mu_z}{\frac{s}{\sqrt n}} \le t_{\frac{a}{2}}(n-1)) = 1-\alpha\\
\Rightarrow P(\overline x - t_{\frac{a}{2}}(n-1)\frac{s}{\sqrt n}\le \mu_z \le \overline x + t_{\frac{a}{2}}(n-1)\frac{s}{\sqrt n}) = 1-a\\ \\ \\
P(-t_{\frac{a}{2}}(n-1)\le  \frac{\overline x - \mu_z}{\frac{s}{\sqrt n}\sqrt{\frac{N-n}{N-1}}} \le t_{\frac{a}{2}}(n-1)) = 1-\alpha
\\
\Rightarrow P(\overline x - t_{\frac{a}{2}}(n-1)\frac{s}{\sqrt n}\sqrt{\frac{N-n}{N-1}}\le \mu_z \le \overline x + t_{\frac{a}{2}}(n-1)\frac{s}{\sqrt n}\sqrt{\frac{N-n}{N-1}}) = 1-a
$$

#### 切比雪夫定理与总体均值的区间估计

$$
非正态分布总体且小样本情况\\
P(\overline x - k \sigma_c \le \mu_c \le \overline x + k \sigma_c) = 1-\frac{1}{k^2}
\\
\Rightarrow 置信区间公式\overline x\pm k \frac{\sigma_z}{\sqrt n}\: 或\:\: \overline x\pm k \frac{\sigma_z}{\sqrt n}\sqrt{\frac{N-n}{N-1}}
$$

#### 卡方分布与总体方差放到区间估计

估计离散程度
$$
P(\chi_{1-\frac{a}{2}}^2(n-1) \le\frac{(n-1)s^2}{\sigma_z^2}\le\chi_{1-\frac{a}{2}}^2(n-1)) = 1-a     \\
(\chi 中的n-1为查表使用参数，用于确定\chi的具体值)\\
\frac{(n-1)s^2}{\chi_{\frac{a}{2}}^2(n-1)} \le\sigma^2_z\le \frac{(n-1)s^2}{\chi_{1-\frac{a}{2}}^2(n-1)}
$$

#### F分布于两个总体方差比的区间估计

$$
F(F_{1-\frac{a}{2}}(n_1-1,n_2-1)\le\frac{s_1^2\sigma^2_2}{s_2^2\sigma^2_1}\le F_{\frac{a}{2}}(n_1-1,n_2-1)) = 1-a
\\\Rightarrow
P(\frac{1}{F_{\frac{a}{2}}(n_1-1,n_2-1)}\frac{s_1^2}{s_2^2}\le\frac{\sigma_1^2}{\sigma_2^2}\le\frac{1}{F_{1-\frac{a}{2}}(n_1-1,n_2-1)}\frac{s_1^2}{s_2^2}) = 1-a
$$

#### 两个总体均值差的区间估计

#### 独立样本与配对样本：

独立样本：从一个总体中选取样本，抽样形式无论证明改变都不会影响从另一个总体中抽取样本的概率，则这两个随机样本为独立样本。

配对样本，如果 从一个总体中凑趣样本的行为以某种方式决定了从另一个总体中抽取样本的概率，那么称这两个样本为成对i样本或配对样本。

大部分情况下 因为实验无法同时作用于同一组实验对象上进行，所以独立样本是唯一的选择。但因为配对样本能更好的控制实验变量，所以应当在能选择配对样本的地方就使用配对样本。

#### 两个总体均值差的区间估计基础

要得到两个总体均值差的置信区间公式，就需要将单个总体均值的抽样分布推广到两个总体均值差的抽样分布，然后利用连个总体均值差的抽样分布推导出两个总体均值差的置信空间。

均值和方差的数据特点：如果两个总体合并，则合并后的总体均值等于原两个总体均值之和或之差，但合并后的总体方差都等于两个总体方差之和。

均值差的区间估计：总体标准差($\sigma^2_{z1},\sigma^2_{z2}$)已知的正态分布独立样本
独立大样本情况下 总体均值差的均值差抽样分布服从正态分布 使用Z分布对两个总体均值差的置信区间公式进行推导
$\mu_{Z1}-\mu_{Z2}\rightarrow(\overline{x}_{1}-\overline{x}_2\pm z_{\frac{a}{2}}\sqrt{\frac{\sigma^2_{Z1}}{n_1}+\frac{\sigma^2_{Z2}}{n_2}})$

均值差的区间估计：总体标准差未知，正态分布总体的独立样本
小样本情况下使用T分布进行推导

#### 总体比率的区间估计：

#### 样本容量的确定：

总体均值区间估计的样本容量确定
$$
n = (\frac{Z_{a/2}\sigma}{\Delta \mu})^2\\
或\  n = (\frac{NZ^2_{a/2}\sigma ^2}{(N-1)\Delta \mu^2 +Z^2_{a/2}\sigma ^2})^2\\
\sigma \ 总体标准差\\
Z\ 置信区间
\\\mu \ 允许的抽样误差
$$
总体方差区间估计的样本容量确定
$$
n = \frac{\sqrt{2}z_{a/2}s^2}{\Delta \sigma^2}\\
\sigma \ 总体标准差\\
s\ 样本标准差
$$
总体比率区间估计的样本容量确定

### 假设检验